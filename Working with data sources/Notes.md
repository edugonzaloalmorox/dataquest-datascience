# Introduction to Databases


- Working with `.csv` files is important when. 

        - Data fits in memory.

        - Data is relatively static (does not need to be loaded into memory)

        - Only a single person is accessing the data

        - Security is not too important

- Otherwise, it is more convenient to work with data store in database.

- A database is a data representation that lives in a disk and can be queried, accessed and updated without using much memory. 

- `SQL` is used to work with data stored in database. Each unique request is considered a single query.

-  `Microsoft Azure` and `AWS` are setups in the cloud.

-  `Postgres`  and `MySQL` include powerful features for managing user credentials, security, and high data throughput (quickly changing data).

## Main query functions

- `select`: select columns 

- `where`: filtering columns

    - in `where` you can add conditions (`and`, `or`)

- We can use () to enclose the logic we want and evaluated it in the parentheses.

- `ORDER BY` is used to rank the queries. 

## Summary statistics

- In SQL everything is a table.

    - Good for reaching wider audiences

    - Bad since it requires conversions of numbers and dataframes

- `Aggregate functions` are applied over columns of values and return a single value

## Group summary statistics

- `GROUP BY` allows for grouped operations. It is possible to compute summary statistics by unique value of the group.

## Querying Virtual Columns With the HAVING Statement

- We canÂ´t use `WHERE` after `GROUP BY`. For example use `WHERE` on variables that are have been created. 

- We use `HAVING` whe we we want to filter on a column generated by a `GROUP BY` query

- We use  `ROUND` to round decimal values


## Other functions of interest

- `PRAGMA_TABLE_INFO(table)` gives information on the table

- `CAST()` is used when we divide two integer columns and we want to keep the decimal - otherwise it returns an integer number. This is called 
**`casting`** 


## Subqueries

- SQL is a declarative language programming. 

- Subqueries subquery is a query nested within another query. It is hosted in a `where` clause.

- Using the `IN` operator, we can specify a list of values that we want to match against in the `WHERE` clause.


Connect to a database (e.g. `jobs.db`)


`import sqlite3`

`conn = sqlite3.connect('jobs.db')`

Cursor class is used to: 


- Run a query against the database
- Parse the results from the database
- Convert the results to native Python objects
- Store the results within the Cursor instance as a local variable

To return a cursor instance corresponding to a database:

`cursor = conn.cursor()`

`Tuple`: number of values separated by commas. This is similar to a list but they are immutable and faster than lists. They are more suitable for big datasets.


`# SQL Query as a string`
`query = "select * from recent_grads;"`

`# Execute the query, convert the results to tuples, and store as a local variable`
`cursor.execute(query)`

`# Fetch the full results set as a list of tuples`
`results = cursor.fetchall()`

`# Display the first three results`
`print(results[0:3])`


The SQLite library actually allows us to skip creating a Cursor altogether by using the `execute` method within the Connection object itself

`conn = sqlite3.connect("jobs.db")`
`query = "select * from recent_gr`

- `fetchone()`: cursor method to return a single result
- `fetchmany()`: cursor method to return `n()` results.

To close a connection we have to use the Connection instance method `close()`



